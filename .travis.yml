language: rust
sudo: required
dist: bionic
addons:
  apt:
    packages:
      - gfortran
      - musl-tools
matrix:
  fast_finish: true
  include:
    - os: linux
      rust: stable
      env: TARGET=x86_64-unknown-linux-gnu
    - os: linux
      rust: stable
      env: TARGET=x86_64-unknown-linux-musl
    - os: linux
      rust: 1.32.0
      env: TARGET=x86_64-unknown-linux-gnu
install:
  - |
    if [[ $TRAVIS_OS_NAME = linux && ${TARGET} != x86_64-unknown-linux-gnu ]]; then
      rustup target add ${TARGET}
    else
      rustup component add clippy
      rustup component add rustfmt
    fi
script: ci/script.sh
